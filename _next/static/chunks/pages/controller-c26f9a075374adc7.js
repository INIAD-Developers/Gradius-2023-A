(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{1319:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/controller",function(){return t(1868)}])},1868:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return v}});var r=t(5893),l=t(5904);let o=l.z.string().brand();l.z.string().brand(),l.z.string().brand(),l.z.string().brand();var s=t(1163),i=t(7294),a=t(2642),u=t(1290),c=t(1440),d=t.n(c);let _=()=>{var n,e;let t=(0,i.useRef)(null),[l,c]=(0,i.useState)(),[_,v]=(0,i.useState)(null),h=(0,i.useRef)({x:0,y:0}),[f,x]=(0,i.useState)(o.parse(localStorage.getItem("userId"))),m=(0,s.useRouter)();null===localStorage.getItem("userId")&&m.push("/gradiusLogin");let y=()=>{if(null!==t.current){let n={x:window.innerWidth,y:window.innerHeight};c(n)}};(0,i.useEffect)(()=>{let n=setInterval(y,100);return()=>{clearInterval(n)}},[]);let b=async()=>{null!==f&&await u.x.rooms.bulletPosition.$post({body:f})},g=async()=>{null!==f&&await u.x.rooms.control.$post({body:{moveDirection:h.current,userId:f}})},j=()=>{let n=setInterval(g,50);v(n)},w=()=>{null!==_&&clearInterval(_)},p=n=>{var e,t;let r={x:Math.round(null!==(e=n.x)&&void 0!==e?e:0),y:-Math.round(null!==(t=n.y)&&void 0!==t?t:0)};h.current=r};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:d().container,children:[(0,r.jsx)("div",{className:d().info,children:(0,r.jsx)("p",{children:"スコア:"})}),(0,r.jsx)("div",{ref:t,className:d().joystick,children:(0,r.jsx)(a.Tj,{size:Math.min(null!==(n=null==l?void 0:l.x)&&void 0!==n?n:0,null!==(e=null==l?void 0:l.y)&&void 0!==e?e:0)/2,baseColor:"gray",stickColor:"lightyellow",baseShape:a.aR.Square,move:p,stop:w,start:j})}),(0,r.jsx)("div",{className:d().button,onClick:b})]}),(0,r.jsxs)("details",{children:[(0,r.jsx)("summary",{children:"デバッグ"}),(0,r.jsxs)("div",{children:["userId: ",f]})]})]})};var v=_},1440:function(n){n.exports={container:"controller_container__KQG_B",info:"controller_info__i_TW1",joystick:"controller_joystick__zB95Y",button:"controller_button__HhcWm"}}},function(n){n.O(0,[435,774,888,179],function(){return n(n.s=1319)}),_N_E=n.O()}]);